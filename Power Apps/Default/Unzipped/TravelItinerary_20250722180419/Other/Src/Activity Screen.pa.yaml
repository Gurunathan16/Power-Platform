# ************************************************************************************************
# Warning: YAML source code for Canvas Apps should only be used to review changes made within Power Apps Studio and for minor edits (Preview).
# Use the maker portal to create and edit your Power Apps.
# 
# The schema file for Canvas Apps is available at https://go.microsoft.com/fwlink/?linkid=2304907
# 
# For more information, visit https://go.microsoft.com/fwlink/?linkid=2292623
# ************************************************************************************************
Screens:
  Activity Screen:
    Properties:
      Fill: =RGBA(255, 255, 255, 1)
      LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    Children:
      - Activity Form Container:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Height: =App.Height - ('Activity Header Container'.Height + 'AS Buttons Container'.Height)
            Width: =Parent.Width
            Y: ='Activity Header Container'.Height
          Children:
            - Activity Form:
                Control: Form@2.4.4
                Layout: Horizontal
                Properties:
                  BorderColor: =RGBA(245, 245, 245, 1)
                  DataSource: ='Travel Itinerary Activity'
                  DefaultMode: =FormMode.New
                  Height: =Parent.Height
                  NumberOfColumns: =4
                  Width: =Parent.Width
                Children:
                  - Day_DataCard1:
                      Control: TypedDataCard@1.0.7
                      Variant: NumberEdit
                      Properties:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        DataField: ="Day_x0021_"
                        Default: =ThisItem.Day
                        DisplayName: =DataSourceInfo([@'Travel Itinerary Activity'],DataSourceInfo.DisplayName,'Day_x0021_')
                        Required: =true
                        Update: =Value(DataCardValue11.Value)
                        Width: =Round(Parent.Width / 4, 0) - 1
                        X: =0
                        Y: =0
                      Children:
                        - DataCardKey11:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Font: =Font.'Segoe UI'
                              Height: =Round(Parent.Height * 0.52, 0)
                              Text: =Parent.DisplayName
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Round(Parent.Width * 0.35, 0)
                              Wrap: =false
                              X: =Round(Parent.Width * 0.1, 0)
                              Y: =Round((Parent.Height - DataCardValue11.Height) / 2,0)
                        - DataCardValue11:
                            Control: NumberInput@2.9.12
                            MetadataKey: FieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              Appearance: ='NumberInput.Appearance'.Outline
                              BasePaletteColor: =RGBA(227, 106, 244, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              DisplayMode: =Parent.DisplayMode
                              FontSize: =14
                              Height: =Round(Parent.Height * 0.52, 0)
                              Max: =Blank()
                              Min: =Blank()
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Value: =Parent.Default
                              Width: =Round((Parent.Width - 48) * 0.6, 0)
                              X: =DataCardKey11.X + DataCardKey11.Width
                              Y: =Round((Parent.Height - DataCardValue11.Height) / 2,0)
                        - ErrorMessage11:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =DataCardValue11.Y + DataCardValue11.Height
                  - Time_DataCard2:
                      Control: TypedDataCard@1.0.7
                      Variant: DateTimeEdit
                      Properties:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        DataField: ="Time"
                        Default: =ThisItem.Time
                        DisplayName: =DataSourceInfo([@'Travel Itinerary Activity'],DataSourceInfo.DisplayName,Time)
                        Required: =true
                        Update: =If(Value(HourValue6.Selected.Value), Value(MinuteValue6.Selected.Value))
                        Width: =Round(Parent.Width / 4, 0) - 1
                        X: =1
                        Y: =0
                      Children:
                        - DataCardKey29:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Font: =Font.'Segoe UI'
                              Height: =Round(Parent.Height * 0.52, 0)
                              Text: =Parent.DisplayName
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Round(Parent.Width * 0.35, 0)
                              Wrap: =false
                              X: =Round(Parent.Width * 0.1, 0)
                              Y: =Round((Parent.Height - HourValue6.Height) / 2,0)
                        - HourValue6:
                            Control: DropDown@0.0.45
                            MetadataKey: HourFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              Appearance: ='DropdownCanvas.Appearance'.Outline
                              BasePaletteColor: =RGBA(227, 106, 244, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              DefaultSelectedItems: =[Text(Hour(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              FontSize: =14
                              Height: =Round(Parent.Height * 0.52, 0)
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =Round((DataCardValue26.Width / 2), 0) - 5
                              X: =DataCardKey29.X + DataCardKey29.Width
                              Y: =Round((Parent.Height - DataCardValue9.Height) / 2,0)
                        - Separator6:
                            Control: Text@0.0.51
                            MetadataKey: HourMinuteSeparator
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Font: =Font.'Segoe UI'
                              Height: =HourValue6.Height
                              Size: =20
                              Text: =":"
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =10
                              X: =HourValue6.X + HourValue6.Width
                              Y: =HourValue6.Y
                        - MinuteValue6:
                            Control: DropDown@0.0.45
                            MetadataKey: MinuteFieldValue
                            Properties:
                              AccessibleLabel: =If(Parent.Required, Substitute("{0}. Required.", "{0}", Parent.DisplayName), Parent.DisplayName)
                              Appearance: ='DropdownCanvas.Appearance'.Outline
                              BasePaletteColor: =RGBA(227, 106, 244, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              DefaultSelectedItems: =[Text(Minute(Parent.Default),"00")]
                              DisplayMode: =Parent.DisplayMode
                              FontSize: =14
                              Height: =Round(Parent.Height * 0.52, 0)
                              Items: =["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"]
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Width: =HourValue6.Width
                              X: =HourValue6.X + HourValue6.Width + Separator6.Width
                              Y: =HourValue6.Y + 1
                        - ErrorMessage29:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                  - Activity_DataCard2:
                      Control: TypedDataCard@1.0.7
                      Variant: TextualEdit
                      Properties:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        DataField: ="Activity"
                        Default: =ThisItem.Activity
                        DisplayName: =DataSourceInfo([@'Travel Itinerary Activity'],DataSourceInfo.DisplayName,Activity)
                        MaxLength: =DataSourceInfo([@'Travel Itinerary Activity'], DataSourceInfo.MaxLength, Activity)
                        Required: =true
                        Update: =DataCardValue26.Value
                        Width: =Round(Parent.Width / 4, 0) - 1
                        X: =2
                        Y: =0
                      Children:
                        - DataCardKey30:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Font: =Font.'Segoe UI'
                              Height: =Round(Parent.Height * 0.52, 0)
                              Text: =Parent.DisplayName
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Round(Parent.Width * 0.35, 0)
                              Wrap: =false
                              X: =Round(Parent.Width * 0.1, 0)
                              Y: =Round((Parent.Height - DataCardValue26.Height) / 2,0)
                        - DataCardValue26:
                            Control: TextInput@0.0.54
                            MetadataKey: FieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              Appearance: ='TextInputCanvas.Appearance'.Outline
                              BasePaletteColor: =RGBA(227, 106, 244, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              DisplayMode: =Parent.DisplayMode
                              Font: =Font.'Segoe UI'
                              FontSize: =14
                              FontWeight: =FontWeight.Semibold
                              Height: =Round(Parent.Height * 0.52, 0)
                              Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Value: =Parent.Default
                              Width: =Round((Parent.Width - 48) * 0.6, 0)
                              X: =DataCardKey30.X + DataCardKey30.Width + 8
                              Y: =Round((Parent.Height - DataCardValue26.Height) / 2,0)
                        - ErrorMessage30:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =DataCardValue26.Y + DataCardValue26.Height
                  - Destination/Place_DataCard2:
                      Control: TypedDataCard@1.0.7
                      Variant: TextualEdit
                      Properties:
                        BorderColor: =RGBA(245, 245, 245, 1)
                        DataField: ="Destination_x002f_Place"
                        Default: =ThisItem.'Destination/Place'
                        DisplayName: =DataSourceInfo([@'Travel Itinerary Activity'],DataSourceInfo.DisplayName,'Destination/Place')
                        MaxLength: =DataSourceInfo([@'Travel Itinerary Activity'], DataSourceInfo.MaxLength, 'Destination/Place')
                        Required: =true
                        Update: =DataCardValue30.Value
                        Width: =Round(Parent.Width / 4, 0) - 1
                        X: =3
                        Y: =0
                      Children:
                        - DataCardKey33:
                            Control: Text@0.0.51
                            MetadataKey: FieldName
                            Properties:
                              Font: =Font.'Segoe UI'
                              Height: =Round(Parent.Height * 0.52, 0)
                              Text: =Parent.DisplayName
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Round(Parent.Width * 0.35, 0)
                              Wrap: =false
                              X: =Round(Parent.Width * 0.1, 0)
                              Y: =Round((Parent.Height - DataCardValue30.Height) / 2,0)
                        - DataCardValue30:
                            Control: TextInput@0.0.54
                            MetadataKey: FieldValue
                            Properties:
                              AccessibleLabel: =Parent.DisplayName
                              Appearance: ='TextInputCanvas.Appearance'.Outline
                              BasePaletteColor: =RGBA(227, 106, 244, 1)
                              BorderRadius: =10
                              BorderStyle: =BorderStyle.Solid
                              BorderThickness: =2
                              DisplayMode: =Parent.DisplayMode
                              Font: =Font.'Segoe UI'
                              FontSize: =14
                              FontWeight: =FontWeight.Semibold
                              Height: =Round(Parent.Height * 0.52, 0)
                              Mode: ="'TextInputCanvas.Mode'.TextInputModeSingleLine"
                              Required: =Parent.Required
                              ValidationState: =If(IsBlank(Parent.Error), "None", "Error")
                              Value: =Parent.Default
                              Width: =Round((Parent.Width - 48) * 0.6, 0)
                              X: =DataCardKey33.X + DataCardKey33.Width
                              Y: =Round((Parent.Height - DataCardValue30.Height) / 2,0)
                        - ErrorMessage33:
                            Control: Text@0.0.51
                            MetadataKey: ErrorMessage
                            Properties:
                              Height: =30
                              Text: =Parent.Error
                              Visible: =And(!IsBlank(Parent.Error), Parent.DisplayMode=DisplayMode.Edit)
                              Width: =Parent.Width - 48
                              X: =24
                              Y: =DataCardValue30.Y + DataCardValue30.Height
      - Activity Header Container:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Group: Activity Header
          Properties:
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Fill: =RGBA(116, 39, 116, 1)
            Height: =Round(Parent.Height * 0.1041, 0)
            LayoutDirection: =LayoutDirection.Vertical
            Width: =Parent.Width
      - Activity Label:
          Control: Label@2.5.1
          Group: Activity Header
          Properties:
            Align: =Align.Center
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =RGBA(255, 255, 255, 1)
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            DisabledColor: =RGBA(161, 159, 157, 1)
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Bold
            Height: =Round(Parent.Height * 0.1041, 0)
            Size: =30
            Text: ="Activity"
            Width: =Parent.Width
      - AS Buttons Container:
          Control: GroupContainer@1.3.0
          Variant: AutoLayout
          Properties:
            BorderStyle: =BorderStyle.None
            DropShadow: =DropShadow.None
            Height: =Round(Parent.Height * 0.12, 0) - 18
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Horizontal
            LayoutGap: =16
            LayoutJustifyContent: =LayoutJustifyContent.Center
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width
            Y: =Parent.Height - 'AS Buttons Container'.Height
          Children:
            - AS Cancel Button:
                Control: Button@0.0.45
                Properties:
                  AccessibleLabel: ="Cancel form button"
                  Align: =Align.Center
                  Appearance: ='ButtonCanvas.Appearance'.Secondary
                  BasePaletteColor: =RGBA(227, 106, 244, 1)
                  Height: =Round(Parent.Height * 0.5, 0)
                  Icon: ="Dismiss"
                  OnSelect: |-
                    =ResetForm('Hotel Form');
                    ResetForm('MoT Form');
                  Text: ="Cancel"
                  Width: =Round(Parent.Width * 0.09, 0)
            - AS Home Button:
                Control: Button@0.0.45
                Properties:
                  AccessibleLabel: ="Submit form button"
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(227, 106, 244, 1)
                  Height: =Round(Parent.Height * 0.5, 0)
                  Icon: ="Home"
                  OnSelect: =Navigate('Home Screen');
                  Text: ="Home"
                  Width: =Round(Parent.Width * 0.09, 0)
                  X: =40
                  Y: =40
            - BD Home Button_3:
                Control: Button@0.0.45
                Properties:
                  AccessibleLabel: ="Submit form button"
                  Align: =Align.Center
                  BasePaletteColor: =RGBA(227, 106, 244, 1)
                  Height: =Round(Parent.Height * 0.5, 0)
                  Icon: ="ArrowLeft"
                  OnSelect: =Back(ScreenTransition.Fade)
                  Text: ="Back"
                  Width: =Round(Parent.Width * 0.09, 0)
                  X: =40
                  Y: =40
            - AS Submit Button:
                Control: Button@0.0.45
                Properties:
                  AccessibleLabel: ="Next Screen Button"
                  BasePaletteColor: =RGBA(227, 106, 244, 1)
                  Height: =Round(Parent.Height * 0.5, 0)
                  Icon: ="Save"
                  OnSelect: |+
                    =Patch('Travel Itinerary Basic Details', Defaults('Travel Itinerary Basic Details'), 'BD Form'.Updates);
                    Patch('Travel Itinerary MoT Details', Defaults('Travel Itinerary MoT Details'), 'MoT Form'.Updates);
                    Patch('Travel Itinerary Hotel Details', Defaults('Travel Itinerary Hotel Details'), 'Hotel Form'.Updates);
                    Patch('Travel Itinerary Activity', Defaults('Travel Itinerary Activity'),'Activity Form'.Updates);

                    ResetForm('BD Form');
                    ResetForm('MoT Form');
                    ResetForm('Hotel Form');
                    ResetForm('Activity Form');

                    Navigate('Home Screen')

                  Text: ="Submit"
                  Width: =Round(Parent.Width * 0.09, 0)
